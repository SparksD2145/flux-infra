---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: honeygain
  namespace: tools
spec:
  selector:
    matchLabels:
      app: honeygain
  replicas: 5
  template:
    metadata:
      labels:
        app: honeygain
    spec:
      containers:
        - name: honeygain
          image: honeygain/honeygain:0.6.6
          env:
            - name: POD_ID
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
          args:
            - -tou-accept
            - -email
            - ${TOOLS_HONEYGAIN_ACCOUNT}
            - -pass
            - ${TOOLS_HONEYGAIN_PASSWORD}
            - -device
            - "K8s-$(POD_ID)"
      restartPolicy: OnFailure
